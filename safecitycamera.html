<!DOCTYPE html>
<html>

<head>
  <title>Safe City Camera</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

  <script type='text/javascript'>

          // JavaScript anonymous function
          (() => {
              if (window.localStorage) {

                  // If there is no item as 'reload'
                  // in localstorage then create one &
                  // reload the page
                  if (!localStorage.getItem('reload')) {
                      localStorage['reload'] = true;
                      window.location.reload();
                  } else {

                      // If there exists a 'reload' item
                      // then clear the 'reload' item in
                      // local storage
                      localStorage.removeItem('reload');
                  }
              }
          })(); // Calling anonymous function here only
      </script>

<style>
  .result1{
    background-color: #004e77;
    color:#fff;
    padding:20px;
  }
  .row{
    display:flex;
  }

</style>

<style>
  .result{
    background-color: #141941;
    color:#fff;
    padding:20px;
  }
  .row{
    display:flex;
  }

</style>

<style>
a { text-decoration: none; }

a:link {
color: #fff;
background-color: transparent;
text-decoration: none;
}
a:visited {
color: #fff;
background-color: transparent;
text-decoration: none;
}
a:hover {
color: #fff;
background-color: transparent;
text-decoration: underline;
}
a:active {
color: #f7a14c;
background-color: transparent;
text-decoration: underline;
}

#scroll-text{
    width: 250px;
    overflow-x: scroll;
}

</style>


</head>

<body style="background-color: #1b409b;">

<center><b><p style="color:#231e20;"><img src="https://theorytest.org.uk/wp-content/uploads/2021/01/speed-camera-sign-300x257.png" width="140" height="90">&nbsp;  Speed Camera Detector</img></p></b> </center><br>

<center>
  <div>

    <div style="width:100%;" id="permissioninfo"><p style="color:lime;"> 'Allow GeoLocation Permission If Not Yet <br> Setting>Apps>Permission' </p></div>

  </div>
</center>


<center><div id="status"><h2 style="color:red;">GPS OFF !</h2></div></center>
<center><div id="speedcamera"><h2 style="color:white;">Nearest Camera :</h2></div></center>
<center><h4 style="color:white;"><div id="distance"></div>Km</h4></center>
<center><h4 style="color:lime;" ><div id="camera">Enable GPS Location!</div></h4></center>
<center><input id='notification' value='' onchange='playOnChange()'></input></center>



<script type="text/javascript">

var mp3_url = 'https://media.geeksforgeeks.org/wp-content/uploads/20190531135120/beep.mp3';

function playOnChange() {
    (new Audio(mp3_url)).play();

}

</script>




<script>

// Get User's Coordinate from their Browser
window.onload = function() {
  // HTML5/W3C Geolocation
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(UserLocation);
  }
  // Default to Washington, DC
  else
    NearestCity(38.8951, -77.0367);
}

// Callback function for asynchronous call to HTML5 geolocation
function UserLocation(position) {
  NearestCity(position.coords.latitude, position.coords.longitude);
}


// Convert Degress to Radians
function Deg2Rad(deg) {
  return deg * Math.PI / 180;
}

function PythagorasEquirectangular(lat1, lon1, lat2, lon2) {
  lat1 = Deg2Rad(lat1);
  lat2 = Deg2Rad(lat2);
  lon1 = Deg2Rad(lon1);
  lon2 = Deg2Rad(lon2);
  var R = 6371; // km
  var x = (lon2 - lon1) * Math.cos((lat1 + lat2) / 2);
  var y = (lat2 - lat1);
  var d = Math.sqrt(x * x + y * y) * R;
  return d;
}

var lat = 20; // user's latitude
var lon = 40; // user's longitude

var cities = [
  ["Phoenix", 20.24200958152419, 57.57793519061144, "blah"],
  ["Phoenix1", -20.2393125440585, 57.56713425525345, "blah"],
  ["Home", -20.241983786836855, 57.56789696913621, "Speed Camera"],
  ["city3", 20.24201901860385, 57.567900321897184, "Moved"],
  ["city4", -20.251800756206347, 57.55870584026928, "blah"]
];






function NearestCity(latitude, longitude) {
  var minDif = 1.5;
  var closest;

  for (index = 0; index < cities.length; ++index) {
    var dif = PythagorasEquirectangular(latitude, longitude, cities[index][1], cities[index][2]);
    if (dif < minDif) {
      closest = index;
      minDif = dif;
    }
  }

  // echo the nearest city
  //alert(cities[closest]);
  document.getElementById('camera').innerHTML = (cities[closest]);
  document.getElementById('status').innerHTML = '<h2 style="color:lime;">GPS ON</h2>';
  document.getElementById('distance').innerHTML = minDif.toFixed(3);

  document.getElementById('notification').value = (cities[closest]);
  document.getElementById("permissioninfo").remove();

}








setInterval(function(){
    window.onload()
}, 30000)


</script>









<br>
<center><h5 style="color:#fff;">Any ticket number requested through this application is neither stored nor read by any third party. Note: Ticket scannable 6 month from date of draw.</h5></center>


<br><br><br>
<center> <p style="color:#FFF;">Coded with <span style="color:red">&#x2764;</span> by <a href="http://madeinmaurice.net"><b><span style="color:red">Made</span><span style="color:blue">In</span><span style="color:yellow">Maurice</span>.<span style="color:green">net</span> ðŸ‡²ðŸ‡º</b></a></p></center>


<center> <p> <a href="http://madeinmaurice.net/disclaimer"><b><span style="color:grey">TOS | PRIVACY | DISCLAIMER</span></b></a></p></center>





</body>

</html>
